---
- name: Execute vgs to report the volume groups
  ansible.builtin.command:
    argv:
      - /usr/sbin/vgs
      - "--reportformat=json"
  register: lvm_vgs_raw
  changed_when: false
  check_mode: false
  become: true

- name: Parse the vgs command output
  ansible.builtin.set_fact:
    lvm_vgs: "{{ ((lvm_vgs_raw.stdout | from_json).report | first).vg }}"

- name: Get the name of the first volume group
  ansible.builtin.set_fact:
    lvm_first_vg: "{{ (lvm_vgs | first).vg_name }}"
  when: (lvm_vgs | length) > 0
