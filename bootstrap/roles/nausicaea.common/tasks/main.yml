---
- name: Install packages
  ansible.builtin.package:
    name:
      - sudo
      - etckeeper
      - acl
      - unattended-upgrades
      - python3-kubernetes
      - python3-jmespath
      - firewalld
      - vim
      - tmux
      - jq
    state: present
  become: true
  notify: Etckeeper commit

- name: Delete the post-install script
  ansible.builtin.file:
    path: /root/post-install.sh
    state: absent
  become: true

- name: Configure the Ansible user
  ansible.builtin.import_tasks:
    file: configure_ansible_user.yml

- name: Configure automatic Ansible pull runs
  ansible.builtin.import_tasks:
    file: configure_ansible_pull.yml

- name: Configure the admin user
  ansible.builtin.import_tasks:
    file: configure_admin_user.yml

- name: Configure Firewalld
  ansible.builtin.import_tasks:
    file: configure_firewalld.yml

