---
- name: Find all APT repo files
  ansible.builtin.find:
    paths:
      - /etc/apt/sources.list.d
    file_type: file
    recurse: true
  register: apt_repository_sources

- name: Comment out any cdrom APT repositories
  ansible.builtin.lineinfile:
    path: "{{ item }}"
    line: "#\\1"
    regexp: "^(deb cdrom:.*)$"
    backrefs: true
  loop: "{{ ['/etc/apt/sources.list', apt_repository_sources.files | map(attribute='path')] | flatten }}"
